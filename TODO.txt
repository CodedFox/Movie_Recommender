THINGS WE COULD IMPLEMENT IN PROJECT SPECIFCATION:

Get rid of password column in users

FORMS FOR LIKES_TOPICS, MOVIE_RATINGS, ETC- ANYTHING WITH FOREIGN KEYS.
MAKE SURE OF ACCESS OF PAGES ARE CORRECT TO CURRENT USER
UPLOADING PICTURE FOR NEW USER
VALIDATIONS FOR DATA
RECOMMENDATIONS
SEARCH BAR

Trailers

=========================================================================================

https://www.checkli.com/checklists/view/68ce3e025ebe8c5598d50126cf40ab61

a) Display all the information about a user-specified movie. That is, the user should select
 the name of the movie from a list, and the information as contained in the movie table
 should then be displayed on the screen.

b) Display the full list of actors, and their roles, of a specific movie. That is, the user should select
the name of the movie from a list, and all the details of the actors, together with their roles,
should be displayed on the screen.

h) Find the total number of rating for each movie, for each user. That is, the data should be
grouped by the movie, the specific users and the numeric ratings they have received.

n) Find the names, join-date and profiling information (age-range, gender, and so on) of the users
that rated a specific movie (say movie Z) the most frequently. Display this information together
with their comments, if any. (Here movie Z refers to a movie of your own choice, e.g. The
Hundred Foot Journey).

Display directs in /movies/id
Display movie_casts in /movies/id
Display movie_roles in /movies/id
Display sponsors in /movies/id

Display movie_ratings in /movies/id
	SELECT avg(user_rating) as avg, count(id) as count, profile_id
	FROM movie_ratings
	GROUP BY profile_id
	ORDER BY count DESC
	WHERE movie_ratings.movie_id = @movie.id
		
		SELECT email, id
		FROM users
		INNER JOIN profiles ON users.id = profiles.user_id
		WHERE profiles.id = ^movie_rating.profile_id		
		
		SELECT review
		FROM movie_ratings
		WHERE movie_ratings.profile_id = ^movie_rating.profile_id AND movie_ratings.movie_id = @movie.id
		
	
	<% @watches =  MovieRating.select("avg(user_rating) as avg, count(id) as count, profile_id").group("profile_id").order(count: :desc).where movie_id: @movie.id %>

	<table>
	  <thead>
		<tr>
		  <th>User</th>
		  <th>Average<br>Rating</th>
		  <th>Times Seen</th>
		  <th>Reviews</th>
		  <th colspan="3"></th>
		</tr>
	  </thead>

	  <tbody>
		<% @watches.each do |watch| %>
		  <% @user = User.joins(:profile).where(profiles: { id: watch.profile_id }).take %>
		  <% @userreviews = MovieRating.where(movie_id: @movie.id, profile_id: watch.profile_id) %>
		  <tr>
			<td><a href="/users/<%= @user.id %>"><%= @user.email %></a></td>
			<td><%= watch.avg %></td>
			<td><%= watch.count %></td>
			<td>
			  <% @userreviews.each do |userreview| %>
				<% if userreview.review != '' %>
				  <%= userreview.review %><br>
				<% end %>
			  <% end %>
			</td>
		  </tr>
		<% end %>
	  </tbody>
	</table>

Display movie_topics in /movies/id
	SELECT genre_name 
	FROM topics
	INNER JOIN movie_topics ON topics.id = movie_topics.topic_id
	WHERE movie_topics.movie_id = @movie.id

	<% @genres = Topic.joins(:movie_topics).where(movie_topics: { movie_id: @movie.id }) %>

	<% @genres.each do |genre| %>
	  <%= genre.genre_name %>
	<% end %>



c) For each user-specified category of movie, list the details of the director(s) and studio(s),
together with the date that the movie has been released. The user should be able to select the
category (e.g. Horror or Nature) from a list.

Display directs in /topics/id
Display sponsors in /topics/id

Display movie_topics in /topics/id
	SELECT *
	FROM movies
	INNER JOIN movie_topics ON movies.id = movie_topics.movie_id
	WHERE movie_topics.topic_id = @topic.id
	
	<% @movies = Movie.joins(:movie_topics).where(movie_topics: { topic_id: @topic.id }) %>

	<table>
	  <thead>
		<tr>
		  <th></th>
		  <th>Movie Name</th>
		  <th>Description</th>
		  <th>Date released</th>
		  <th>Duration</th>
		  <th>Language</th>
		  <th>Subtitles</th>
		  <th>Dubbed</th>
		  <th>Country</th>
		  <th>Age rating</th>
		  <th colspan="3"></th>
		</tr>
	  </thead>

	  <tbody>
		<% @movies.each do |movie| %>
		  <tr>
			<td><img src="<%= movie.poster %>" style="width: 75px"></td>
			<td><%= movie.movie_name %></td>
			<td><%= movie.description %></td>
			<td><%= movie.date_released %></td>
			<td>
			  <% if movie.duration.hour == 0 %>
				<%= movie.duration.strftime('%Mm') %>
			  <% else %>
				<%= movie.duration.strftime('%kh %Mm') %>
			  <% end %>
			</td>
			<td><%= movie.language %></td>
			<td><%= movie.subtitles %></td>
			<td><%= movie.dubbed %></td>
			<td><%= movie.country %></td>
			<td><%= movie.age_rating %></td>

			<td><%= link_to 'Show', movie %></td>
		  </tr>
		<% end %>
	  </tbody>
	</table>

	
	
d) Display the information about the actor that appeared the most often in the movies, as
contained in your database. Display this information together with the details of the director(s)
and the studio(s) that s(he) worked with.

e) Display the information about the two actors that appeared the most often together in the
movies, as contained in your database.

Display movie_casts in /home
Display directs in /home
Display sponsors in /home



f) Find the names of the ten movies with the highest overall ratings in your database.

g) Find the movie(s) with the highest overall rating in your database. Display all the movie details,
together with the topics (tags) associated with it.

i) Display the details of the movies that have not been rated since January 2016.

m) Find the names, join-date and profiling information (age-range, gender, and so on) of the users
that give the highest overall ratings. Display this information together with the names of the
movies and the dates the ratings were done.

Display movie_ratings in /home
Display movie_topics in /home



j) Find the names, release dates and the names of the directors of the movies that obtained rating
that is lower than any rating given by user X. Order your results by the dates of the ratings.
(Here, X refers to any user of your choice.)

DO THIS LAST



k) List the details of the Type Y movie that obtained the highest rating. Display the movie name
together with the name(s) of the rater(s) who gave these ratings. (Here, Type Y refers to any
movie type of your choice, e.g. Horror or Romance.)

Display movie_ratings in /topics



l) Provide a query to determine whether Type Y movies are “more popular” than other movies.
(Here, Type Y refers to any movie type of your choice, e.g. Nature.) Yes, this query is open to
your own interpretation!

DO THIS LAST



o) Find the names and emails of all users who gave ratings that are lower than that of a rater with
a name called John Smith. (Note that there may be more than one rater with this name).

DO THIS LAST



p) Find the names and emails of the users that provide the most diverse ratings within a specific
genre. Display this information together with the movie names and the ratings. For example,
Jane Doe may have rated terminator 1 as a 1, Terminator 2 as a 10 and Terminator 3 as a 3.
Clearly, she changes her mind quite often!

Display movie_ratings in /topics/id
	SELECT max(user_rating) - min(user_rating) as d, max(R.user_rating) as ma, min(R.user_rating) as mi, profile_id
	FROM movie_ratings
	INNER JOIN movie_topics ON movie_ratings.movie_id = movie_topics.movie_id
	WHERE movie_topics.topic_id = @topic.id
	GROUP BY profile_id
	ORDER BY diff DESC
	LIMIT 3
	
		SELECT email, id
		FROM users
		INNER JOIN profiles ON users.id = profiles.user_id
		WHERE profiles.id = ^movie_rating.profile_id
		
		SELECT name
		FROM movies
		INNER JOIN movie_ratings ON movie.id = movie_ratings.movie_id
		INNER JOIN movie_topics ON movie.id = movie_topics.movie_id
		WHERE movie_ratings.rating = ^movie_rating.ma AND movie_ratings.user_id = ^movie_rating.user_id AND movie_topics.topic_id = @topic.id
		
		SELECT name
		FROM movies
		INNER JOIN movie_ratings ON movie.id = movie_ratings.movie_id
		INNER JOIN movie_topics	ON movie.id = movie_topics.movie_id
		WHERE movie_ratings.rating = ^movie_rating.mi AND movie_ratings.user_id = ^movie_rating.user_id AND movie_topics.topic_id = @topic.id

	<% @dusers = MovieRating.
					select("max(user_rating) - min(user_rating) as d, max(user_rating) as ma, min(user_rating) as mi, profile_id").
					joins(:movie_topics).
					where(movie_topics: { topic_id: @topic.id }).
					group("profile_id").
					order('d DESC').
					take(3) %>

	<table>
	  <thead>
		<tr>
		  <th>Diverse Raters</th>
		  <th>Max Movie</th>
		  <th>Rating</th>
		  <th>Min Movie</th>
		  <th>Rating</th>
		  <th>Difference</th>
		  <th colspan="3"></th>
		</tr>
	  </thead>

	  <tbody>
		<% @dusers.each do |duser| %>
		  <% @user = User.joins(:profile).where(profiles: { id: duser.profile_id }).take %>
		  <% @maxmovie = Movie.joins(:movie_ratings, :movie_topics).where(movie_ratings: { user_rating: duser.ma, profile_id: duser.profile_id }, movie_topics: { topic_id: @topic.id }).take %>
		  <% @minmovie = Movie.joins(:movie_ratings, :movie_topics).where(movie_ratings: { user_rating: duser.mi, profile_id: duser.profile_id }, movie_topics: { topic_id: @topic.id }).take %>
			<tr>
				<td><a href="/users/<%= @user.id %>"><%= @user.email %></a></td>
				<td><%= @maxmovie.movie_name %></td>
				<td><%= duser.ma %></td>
				<td><%= @minmovie.movie_name %></td>
				<td><%= duser.mi %></td>
				<td><%= duser.d %></td>
			</tr>
		<% end %>
	  </tbody>
	</table>



=========================================================================================
	
IN /USERS/ID, DISPLAY:
	profiles
		SELECT *
		FROM profiles
		WHERE profile.user_id = @user.id
		
		<% @profile = Profile.find_by user_id: @user.id %>
		
		<%= link_to 'Edit Profile', edit_profile_path(@profile) %>
		
		<p>
		  <strong>First Name:</strong>
		  <%= @profile.first_name %>
		</p>

		<p>
		  <strong>Last Name:</strong>
		  <%= @profile.last_name %>
		</p>

		<p>
		  <strong>Date of Birth:</strong>
		  <%= @profile.date_of_birth %>
		</p>

		<p>
		  <strong>Gender:</strong>
		  <%= @profile.gender %>
		</p>

		<p>
		  <strong>City:</strong>
		  <%= @profile.city %>
		</p>

		<p>
		  <strong>Province:</strong>
		  <%= @profile.province %>
		</p>

		<p>
		  <strong>Country:</strong>
		  <%= @profile.country %>
		</p>

		<p>
		  <strong>Occupation:</strong>
		  <%= @profile.occupation %>
		</p>

		<p>
		  <strong>Picture:</strong>
		  <%= @profile.picture %>
		</p>
		
	likes_topics
		SELECT genre_name
		FROM topics
		INNER JOIN likes_topics ON topics.id = likes_topics.topic_id
		WHERE likes_topics.profile_id = @profile.id
		
		<% @genres = Topic.joins(:likes_topics).where(likes_topics: { profile_id: @profile.id }) %>

		<% @genres.each do |genre| %>
		  <%= genre.genre_name %>
		<% end %>
		
	used_devices
		SELECT device_name
		FROM devices
		INNER JOIN used_devices ON devices.id = used_devices.devices_id
		WHERE used_devices.profile_id = @profile.id
		
		<% @devices = Device.joins(:used_devices).where(used_devices: { profile_id: @profile.id }) %>

		<% @devices.each do |device| %>
		  <%= devices.device_name %>
		<% end %>
	
	movie_ratings
		SELECT *
		FROM movie_rating
		WHERE movie_rating.profile_id = @profile.id
		
			SELECT name
			FROM movies
			WHERE movies.id = ^movie_rating.movie_id

		<% @watched = MovieRating.where profile_id: @profile.id %>

		<table>
		  <thead>
			<tr>
			  <th>Movie</th>
			  <th>Date Watched</th>
			  <th>Rating</th>
			  <th>Review</th>
			  <th>Rating Created</th>
			  <th colspan="3"></th>
			</tr>
		  </thead>

		  <tbody>
			<% @watched.each do |watch| %>
			  <% @movie = Movie.find_by id: watch.movie_id %>
			  <tr>
				<td><%= @movie.movie_name %></a></td>
				<td><%= watch.date_watched %></td>
				<td><%= watch.user_rating %></td>
				<td><%= watch.review %></td>
				<td><%= watch.updated_at %></td>
				<td><%= link_to 'Edit', edit_movie_rating_path(watch) %></td>
				<td><%= link_to 'Destroy', watch, method: :delete, data: { confirm: 'Are you sure?' } %></td>
			  </tr>
			<% end %>
		  </tbody>
		</table>



IN /TOPICS/ID, DISPLAY:
	movie_topics
		c)



IN /MOVIES/ID, DISPLAY:

	movie_topics
		a), b), h), n)
	directs
		a), b), h), n)
	movie_roles
		a), b), h), n)
	movie_casts
		a), b), h), n)
	sponsors
		a), b), h), n)
	movie_ratings
		a), b), h), n)



IN /ACTORS/ID, DISPLAY:

	movie_casts
	actor_roles



IN /DIRECTORS/ID, DISPLAY:

	directs



IN /STUDIOS/ID, DISPLAY:

	sponsors


